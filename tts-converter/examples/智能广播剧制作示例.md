# 智能广播剧制作示例

## 快速开始

### 1. 准备脚本

创建一个包含角色列表的脚本文件：

```markdown
# **我的广播剧**

### **角色列表**

【旁白】全知视角，负责交代背景、环境渲染及转场衔接。

【小明】男主角，十八岁，高中生，性格开朗活泼。

【小红】女主角，十八岁，小明的同学，温柔善良。

【老师】三十岁，班主任，成熟稳重，对学生负责。

【校长】五十岁，老校长，沉稳严肃。

---

【旁白】清晨的阳光透过教室的窗户洒进来，新的一天开始了。

【小明】早上好！今天天气真不错。

【小红】是啊，小明。你昨晚的作业做完了吗？

【小明】当然！我可是认真学习了一整晚呢。

【老师】小明，小红，你们早。今天要考试，记得复习。

【小明】啊？考试？我怎么不知道！

【老师】我昨天上课时已经说过了。你肯定又没听讲。

【小红】老师，小明其实挺努力的，就是有时候太活泼了。

【校长】都在这里干什么呢？快进教室，要上课了。

【旁白】于是，新的一天就在这样热闹的气氛中开始了。
```

### 2. 生成音频

在命令行中运行：

```bash
cd ~/.claude/skills/tts-converter/scripts
python drama_to_audio_v2.py 脚本文件.md 输出音频.mp3
```

### 3. 查看输出

程序会自动：
1. 识别角色列表中的5个角色
2. 分析每个角色的年龄、性别、性格
3. 为每个角色分配合适的声音
4. 根据性格调整语速
5. 在对话前添加角色名提示
6. 生成完整的MP3文件

```bash
[INFO] 识别到 5 个角色
  - 旁白: 旁白, 年轻, 正常
  - 小明: 男, 年轻, 活泼
  - 小红: 女, 年轻, 正常
  - 老师: 男, 成熟, 沉稳
  - 校长: 男, 中年, 沉稳

[INFO] 声音分配结果:
  旁白: 成熟男声
  小明: 活泼男声
  小红: 温柔女声
  老师: 稳重男声 语速-15%
  校长: 成熟男声 语速-15%

[1/9] 旁白: 旁白。清晨的阳光透过教室的窗户洒进来...
[2/9] 小明。早上好！今天天气真不错。
[3/9] 小红。是啊，小明。你昨晚的作业做完了吗？
...

[OK] 音频已生成: 输出音频.mp3
[INFO] 文件大小: 0.8 MB
```

## 高级用法

### 不添加角色名提示

如果你不希望对话前出现角色名：

```bash
python drama_to_audio_v2.py 脚本文件.md 输出音频.mp3 --no-name-prompt
```

### 不使用语速调整

如果你不希望根据性格调整语速：

```bash
python drama_to_audio_v2.py 脚本文件.md 输出音频.mp3 --no-speed-adjustment
```

### 组合使用

同时禁用角色名提示和语速调整：

```bash
python drama_to_audio_v2.py 脚本文件.md 输出音频.mp3 --no-name-prompt --no-speed-adjustment
```

## 角色编写指南

### 基本格式

```
【角色名】角色描述，包括年龄、性别、性格等信息。
```

### 描述建议

**好的描述**：
- ✅ 【小明】十八岁，高中生，性格开朗活泼。
- ✅ 【小红】温柔善良的少女，喜欢读书。
- ✅ 【老师】三十岁的班主任，成熟稳重。

**不够好的描述**：
- ❌ 【小明】一个学生。（缺少年龄和性格）
- ❌ 【小红】人。（信息太少）
- ❌ 【老师】老师。（重复角色名，无额外信息）

### 性格关键词

**急躁类**（语速1.2倍）：
- 急躁、热血、冲动、急切、火爆、正义感过剩

**沉稳类**（语速0.85倍）：
- 沉稳、冷静、成熟、稳重、优雅、疲惫、温柔

**活泼类**（语速1.0倍）：
- 活泼、开朗、欢快、愉快、兴奋、天真

**正常类**（语速1.0倍）：
- 不包含特殊关键词的性格，默认正常语速

### 年龄识别

**数字年龄**：
- 二十二岁 → "年轻"
- 三十五岁 → "成熟"
- 五十岁 → "中年"

**关键词年龄**：
- 少年、青年、年轻 → "年轻"
- 成年、成熟 → "成熟"
- 中年、大叔、阿姨 → "中年"

### 性别识别

**自动识别**：
- 男性关键词：男主角、他、骑士、王子、国王、魔王、父亲
- 女性关键词：女主角、她、公主、女王、少女、母亲
- 特殊角色：旁白 → "旁白"

**优先级**：
- 角色名中的关键词优先级最高
- 描述中的关键词次之
- 默认为女性

## 常见问题

### Q: 角色没有被识别到？

A: 检查以下几点：
1. 确保脚本开头有"角色列表"标题（支持Markdown格式）
2. 角色格式必须是【角色名】描述
3. 角色列表和对话之间要有分隔（如空行或`---`）

### Q: 声音分配不合理？

A: 可以通过以下方式调整：
1. 在角色描述中提供更详细的信息（年龄、性别、性格）
2. 使用明确的性格关键词（如"沉稳"、"急躁"）
3. 如果需要完全控制，可以使用旧版工具`drama_to_audio.py`

### Q: 某些角色的语速不对？

A: 检查角色描述中的性格关键词：
- 如果角色"沉稳"但语速不慢，确保描述中有"沉稳"、"冷静"等关键词
- 如果角色"急躁"但语速不快，确保描述中有"急躁"、"热血"等关键词

### Q: 想要两个角色使用相同声音？

A: 这是正常现象。当声音库中的声音不足时，系统会让多个角色使用相同声音，但会通过不同的语速来区分。这样可以保持声音的多样性。

### Q: 生成的音频中角色名太突兀？

A: 使用`--no-name-prompt`参数：

```bash
python drama_to_audio_v2.py 脚本文件.md 输出音频.mp3 --no-name-prompt
```

## 实战技巧

### 1. 角色数量控制

建议一个广播剧的角色数量控制在3-6个：
- 太少：声音单调
- 太多：声音可能重复

### 2. 性格搭配

合理搭配不同性格的角色：
- 主角：活泼或正常
- 配角A：急躁（制造冲突）
- 配角B：沉稳（平衡气氛）
- 旁白：正常（客观叙述）

### 3. 声音测试

生成完整音频前，先生成一个小测试片段：
```bash
# 只使用前几段对话测试
# 将脚本中的对话保留前5-10条
python drama_to_audio_v2.py 测试脚本.md 测试音频.mp3
```

### 4. 音频质量优化

- 使用UTF-8编码保存脚本
- 避免特殊字符（如表情符号）
- 适当使用标点符号控制语调
- 长对话可以适当分段

## 完整示例

查看完整的异世界骑士脚本示例：
- 脚本文件：`异世界骑士广播剧脚本.md`
- 生成命令：
  ```bash
  cd ~/.claude/skills/tts-converter/scripts
  python drama_to_audio_v2.py \
    "C:/Users/manke/Downloads/异世界骑士广播剧脚本.md" \
    "C:/Users/manke/Downloads/异世界骑士_智能版.mp3"
  ```

## 向后兼容

如果你已经在使用旧版工具`drama_to_audio.py`，不用担心：
- 旧版工具完全不受影响
- 两种工具可以并存
- 你可以根据项目需要选择使用哪个工具

**选择建议**：
- 新项目 → 使用 `drama_to_audio_v2.py`（更智能）
- 已有项目 → 继续使用 `drama_to_audio.py`（稳定）
- 需要精细控制声音 → 使用 `drama_to_audio.py`（灵活）

## 获取帮助

查看命令行帮助：
```bash
python drama_to_audio_v2.py --help
```

查看可用声音：
```bash
python tts.py --list-voices zh
```
